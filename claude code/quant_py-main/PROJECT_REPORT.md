# 한국 주식 퀀트 포트폴리오 시스템 - 프로젝트 리포트

**버전**: 2.1
**기준일**: 2026-02-03
**최종 업데이트**: 2026-02-03

---

## 1. 프로젝트 개요

한국 주식 시장(KOSPI/KOSDAQ)을 대상으로 퀀트 전략을 백테스팅하고, 실제 투자 가능한 포트폴리오를 생성하며, 일별 진입 타이밍을 분석하는 통합 시스템입니다.

### 핵심 기능

| 기능 | 설명 | 실행 시간 |
|------|------|-----------|
| 포트폴리오 생성 | 전략 A/B로 분기별 종목 선정 | ~50분 |
| 백테스팅 | 2015-2025 11년 전략 검증 | ~15분 |
| 일별 모니터링 | 진입 타이밍 자동 분석 + Forward EPS 추가 정보 | ~3분 |
| 텔레그램 알림 | 매수 적기 종목 실시간 알림 | 자동 |

---

## 2. 전략 상세

### 전략 A: 마법공식 (Magic Formula)

**기반**: Joel Greenblatt의 『주식시장을 이기는 작은 책』

**팩터 구성**:
```
이익수익률 (Earnings Yield) = EBIT / EV
투하자본수익률 (ROC) = EBIT / Invested Capital

마법공식 순위 = rank(이익수익률) + rank(ROC)
```

**특징**:
- 저평가 + 고효율 기업 발굴
- 중소형주 중심 (코스닥 비중 ~80%)
- 보수적 MDD (-24.42%)

---

### 전략 B: 멀티팩터 (Multi-Factor)

**팩터 구성**:
```
밸류 (40%): PER, PBR, PCR, PSR → -Z-Score (낮을수록 좋음)
퀄리티 (40%): ROE, GPA, CFO/Assets → Z-Score (높을수록 좋음)
모멘텀 (20%): 12개월 수익률 (최근 1개월 제외)

멀티팩터 점수 = Value*0.4 + Quality*0.4 + Momentum*0.2
```

**특징**:
- 학술적 팩터 결합 (Fama-French + Carhart)
- 모멘텀 데이터 없는 종목 자동 제외
- 공격적 수익률 (CAGR 13.15%)

---

### Forward EPS 컨센서스 (추가 정보)

**역할**: 전략 A/B 선정 종목에 대한 **보조 지표**

**데이터 출처**: FnGuide 컨센서스 (comp.fnguide.com)

**수집 항목**:
```
Forward EPS: 향후 12개월 예상 주당순이익
Forward PER: Forward EPS 기준 PER
목표주가: 애널리스트 평균 목표가
```

**커버리지 현황** (2026-02-03 기준):
- 전략 A/B 종목 중 59.2% (29/49)에 컨센서스 존재
- 코스닥 중소형주는 애널리스트 커버리지 낮음
- **컨센서스 없음 != 투자 부적격** (리서치 부재일 뿐)

**활용 방식**:
- 텔레그램/리포트에서 참고 정보로 표시
- 필터링 기준으로 사용하지 않음 (40.8%가 데이터 없음)

---

## 3. 백테스팅 결과 (2015-2025)

### 성과 지표 비교

| 지표 | KOSPI | 전략 A | 전략 B |
|------|-------|--------|--------|
| **총 수익률** | - | **90.77%** | **102.36%** |
| **CAGR** | 7.58% | **11.98%** | **13.15%** |
| **MDD** | -43.90% | **-24.42%** | -33.90% |
| **Sharpe** | 0.27 | **0.53** | **0.53** |
| **Sortino** | - | 0.78 | 0.80 |
| **Win Rate** | - | 52.64% | 52.36% |

### In-Sample vs Out-of-Sample

| 구간 | 기간 | 전략 A CAGR | 전략 B CAGR |
|------|------|-------------|-------------|
| **In-Sample** | 2015-2023 | 3.01% | 7.06% |
| **Out-of-Sample** | 2024-2025 | **67.50%** | **47.71%** |

**결론**: OOS에서 더 좋은 성과 → 과적합 우려 낮음

### 벤치마크 대비 초과수익

- 전략 A: KOSPI 대비 연 **+4.4%p** 초과수익
- 전략 B: KOSPI 대비 연 **+5.6%p** 초과수익

---

## 4. 현재 포트폴리오 (2026년 2월)

### 전략 A TOP 10 (마법공식)

| 순위 | 종목코드 | 종목명 | 이익수익률 | ROC | 시장 |
|------|----------|--------|-----------|-----|------|
| 1 | 018290 | 브이티 | 14.9% | 44.9% | 코스닥 |
| 2 | 340570 | 티앤엘 | 13.1% | 29.9% | 코스닥 |
| 3 | 200670 | 휴메딕스 | 15.2% | 26.5% | 코스닥 |
| 4 | 383220 | F&F | 14.2% | 25.6% | 코스피 |
| 5 | 067160 | SOOP | 11.7% | 27.8% | 코스닥 |
| 6 | 462870 | 시프트업 | 11.5% | 27.2% | 코스닥 |
| 7 | 033100 | 제룡전기 | 9.7% | 33.3% | 코스닥 |
| 8 | 419530 | SAMG엔터 | 9.0% | 37.7% | 코스닥 |
| 9 | 035900 | JYP Ent. | 8.7% | 38.2% | 코스피 |
| 10 | 439260 | 대한조선 | 10.3% | 27.7% | 코스닥 |

### 전략 B TOP 10 (멀티팩터)

| 순위 | 종목코드 | 종목명 | 멀티팩터 | 밸류 | 퀄리티 | 모멘텀 |
|------|----------|--------|----------|------|--------|--------|
| 1 | 278470 | 에이피알 | 1.74 | -1.57 | 4.81 | 2.25 |
| 2 | 084670 | 동양고속 | 1.09 | 0.04 | -0.80 | 6.96 |
| 3 | 036620 | 감성코퍼레이션 | 1.03 | 0.22 | 2.33 | 0.05 |
| 4 | 489790 | 한화비전 | 1.02 | 2.69 | 0.04 | -0.38 |
| 5 | 000660 | SK하이닉스 | 0.99 | -0.30 | 1.89 | 1.74 |
| 6 | 108490 | 로보티즈 | 0.95 | -1.84 | 0.31 | 7.80 |
| 7 | 419530 | SAMG엔터 | 0.91 | 0.27 | 1.62 | 0.78 |
| 8 | 124500 | 아이티센글로벌 | 0.88 | 0.33 | 0.80 | 2.16 |
| 9 | 204620 | 글로벌텍스프리 | 0.85 | 0.38 | 1.96 | -0.44 |
| 10 | 043260 | 성호전자 | 0.85 | 0.12 | 0.04 | 3.92 |

### 시장 분포

| 전략 | KOSPI | KOSDAQ |
|------|-------|--------|
| A | 6개 (20%) | 24개 (80%) |
| B | 5개 (17%) | 25개 (83%) |

---

## 5. 일별 모니터링 v6.4

### Quality(맛) + Price(값) 2축 점수 시스템

**Quality Score (펀더멘털 매력도)**

| 항목 | 가중치 | 설명 |
|------|--------|------|
| 전략등급 | 25% | A+B > A or B |
| PER | 25% | 낮을수록 고득점 |
| ROE | 20% | 높을수록 고득점 |
| 회복여력 | 15% | 52주 고점 대비 낙폭 |
| MA정배열 | 15% | 5>20>60>120일선 |

**Price Score (진입 타이밍)**

| 항목 | 가중치 | 설명 |
|------|--------|------|
| RSI | 30% | 30-45=100점, **70-80=85점(좋은과열)** |
| 볼린저 | 20% | 하단=100점, 상단+거래량=75점 |
| 거래량 | 20% | 3배=100점, 2배=85점 |
| 이격도 | 15% | -20%=100점, +30%=0점 |
| 52주위치 | 15% | 저점=100점, 신고가+거래량=90점 |

### 4분류 시스템

| 분류 | 이모지 | 조건 | 행동 |
|------|--------|------|------|
| STRONG_MOMENTUM | 🚀 | 신고가+거래량+RSI70-80 | 추세매수 |
| DIP_BUYING | 🛡️ | 급락+지지선+RSI<50 | 저점매수 |
| WAIT_OBSERVE | 🟡 | 양호/타이밍대기 | 관망 |
| NO_ENTRY | 🚫 | 버블/과열/저품질 | 금지 |

### 최근 분석 결과 (2026-02-03)

**TOP 5 종목**:

| 순위 | 종목 | 전략 | 분류 | 맛 | 값 | 결론 |
|------|------|------|------|-----|-----|------|
| 1 | 에스엠 | A+C | 🛡️ | 71 | 75 | 우량주 저점 매수 기회 |
| 2 | SAMG엔터 | A+B | 🛡️ | 67 | 76 | 분할 매수로 평균단가 낮추기 |
| 3 | 시프트업 | A | 🛡️ | 66 | 76 | 분할 매수로 평균단가 낮추기 |
| 4 | 유바이오로직스 | A+B | 🚀 | 62 | 70 | 추세 매매 관점 유효 |
| 5 | 브이티 | A+B | 🛡️ | 77 | 52 | 잃기 힘든 자리 |

**분류별 통계**:
- 🚀 모멘텀: 2개
- 🛡️ 눌림목: 10개
- 🟡 관망: 37개
- 🚫 금지: 26개

---

## 6. 텔레그램 알림 시스템

### 메시지 구조 (3개 메시지)

**메시지 1: 개요 + TOP 3**
```
📊 퀀트 포트폴리오 v6.4
📅 2026.02.03
━━━━━━━━━━━━━━━━━━━━━━━━━

📈 시장 현황
• KOSPI: 2,517 🔺0.5%
• KOSDAQ: 728 🔻0.3%

🏆 TODAY'S TOP 3

1️⃣ 🛡️ 에스엠 (041510)
   맛: 71점 | 값: 75점
   → PER 8.1 저평가 + 볼린저 하단
   💡 우량주 저점 매수 기회
```

**메시지 2: 모멘텀 + 눌림목**
```
🚀 강세 돌파 (2개)
• 유바이오로직스: 맛62 값70
  13,690원 | 52주 고점 근접 + 거래량 7.7배 폭발

🛡️ 저점 매수 (10개)
• 에스엠: 맛71 값75
  PER 8.1 | RSI 44 | PER 저평가 + 볼린저 하단
```

**메시지 3: 관망 + 금지**
```
🟡 관망 (37개)
• 크래프톤: 맛63 값56 (타이밍 관망)
...

🚫 진입 금지 (26개)
• 에이피알: RSI 극과열
...

💡 맛=펀더멘털 | 값=진입타이밍
📈 Quant Bot v6.4 by Volume
```

---

## 7. 기술 스택

### 핵심 라이브러리

| 패키지 | 버전 | 용도 |
|--------|------|------|
| pykrx | 1.2.3 | 한국 주식 데이터 API |
| pandas | 2.2.3 | 데이터 처리 |
| numpy | 2.1.3 | 수치 계산 |
| scipy | - | 통계 함수 (Z-Score) |
| requests | 2.32.3 | HTTP 요청 |
| beautifulsoup4 | 4.12+ | FnGuide 크롤링 |

### 데이터 소스

| 소스 | 제공 데이터 |
|------|------------|
| pykrx (KRX) | 시가총액, OHLCV, 지수 |
| FnGuide | 재무제표 (연간/분기), 컨센서스 (Forward EPS/PER) |

---

## 8. 실행 방법

### 패키지 설치
```bash
pip install pykrx==1.2.3 pandas numpy scipy matplotlib requests beautifulsoup4 lxml pyarrow tqdm
```

### 포트폴리오 생성
```bash
python create_current_portfolio.py  # ~50분 소요
```

### 일별 모니터링
```bash
python daily_monitor.py  # ~3분 소요
```

### 백테스팅
```bash
python full_backtest.py  # ~15분 소요
```

---

## 9. 출력 파일

### 포트폴리오 (`output/`)
- `portfolio_2026_01_strategy_a.csv` - 마법공식 30종목 (메인)
- `portfolio_2026_01_strategy_b.csv` - 멀티팩터 30종목 (메인)
- `portfolio_2026_02_strategy_c.csv` - Forward EPS 참고용 (보조)
- `portfolio_2026_01_report.txt` - 분석 리포트

### 백테스트 (`backtest_results/`)
- `backtest_strategy_A_metrics.json` - 전략 A 성과 지표
- `backtest_strategy_A_returns.csv` - 전략 A 일별 수익률
- `backtest_strategy_B_*.csv/json` - 전략 B 결과
- `backtest_comparison.csv` - 전략 비교

### 일별 리포트 (`daily_reports/`)
- `daily_analysis_YYYYMMDD.json` - JSON 분석 결과
- `daily_analysis_YYYYMMDD.csv` - CSV 상세 데이터
- `daily_report_YYYYMMDD.txt` - 텍스트 리포트

---

## 10. 결론 및 투자 전략

### 전략별 특성

| 특성 | 전략 A (마법공식) | 전략 B (멀티팩터) |
|------|------------------|------------------|
| 성향 | 보수적 | 공격적 |
| MDD | -24.42% | -33.90% |
| 코스닥 비중 | 80% | 83% |
| 적합 투자자 | 안정 추구 | 고수익 추구 |

### 권장 투자 비중

**보수적 투자자**: 전략 A 70% + 전략 B 30%
**공격적 투자자**: 전략 A 30% + 전략 B 70%

### Forward EPS 활용법

- **컨센서스 있는 종목**: Forward PER로 현재 밸류에이션 검증
- **컨센서스 없는 종목**: TTM 기반 PER/PBR만 참고
- 투자 의사결정 시 참고 지표로만 활용

### 리밸런싱 주기

- **분기별 리밸런싱** (3월, 6월, 9월, 12월 말)
- 재무제표 공시 후 45일 대기
- 거래비용 0.3% 가정

---

**생성일**: 2026-02-03
**작성**: Claude Opus 4.5
